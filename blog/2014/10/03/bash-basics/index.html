
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Les Bases De La Ligne De Commandes - Kaneda's Blog</title>
  <meta name="author" content="kanedafromparis">

  
  <meta name="description" content="Les terminaux Un terminal est un accès à un ordinateur central. Sous Linux, on parle de terminal pour l'invite de commande. L'avantage de l'invite &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://kanedafromparis.github.io/blog/2014/10/03/bash-basics/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Kaneda's Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-53332892-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Kaneda's Blog</a></h1>
  
    <h2>A Pensieve blog</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="kanedafromparis.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Les Bases De La Ligne De Commandes</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-10-03T21:53:12+02:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2014</span></span> <span class='time'>9:53 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><h2><img class="left half" src="images/blog_run.svg" width="150" height="120" title="Main theme is run" alt="Run"></h2>

<h2>Les terminaux</h2>

<p>Un terminal est un accès à un ordinateur central. Sous Linux, on parle de terminal pour l'invite de commande. L'avantage de l'invite de commande à mon avis est que c'est :</p>

<ul>
<li>simple</li>
<li>relativement standard (malgré des querelles d'interpréteur que je ne développerais pas maintenant)</li>
<li>faible coût et faible coût réseau</li>
<li>facilement automatisable</li>
</ul>


<p>C'est pourquoi c'est sans doute l'outil de base qu'il faut apprendre à maîtriser en priorité. IMHO (à mon humble avis), c'est l'essence de l'informatique, le reste devrait découler naturellement dans l'optique basic de ce simplifier la vie.</p>

<h3>l'enchaînement des commandes</h3>

<p>Mes commandes de prédilections sont :</p>

<ul>
<li><em>cat</em> et <em>zcat</em> pour afficher les contenus d'un fichier</li>
<li><em>less</em> et <em>zless</em> pour afficher les contenus d'un fichier de façon interactive</li>
<li><em>grep</em> pour trouver un morceau de texte dans un long fichier</li>
<li><em>tail</em> pour afficher la fin d'un fichier texte</li>
<li><em>tail -f</em> pour afficher la fin d'un fichier texte et</li>
<li><em>mnon</em> qui affiche l'activité de mon serveur</li>
<li><em>sed</em> pour remplacer un morceau de TEXT par un autre</li>
<li><em>sudo</em> pour passer des commandes avec des droits particuliers (souvent, root)</li>
</ul>


<p>Je pense qu'il faut comprendre l'idée des &ldquo;pipe&rdquo; (tuyaux) en priorité. L'idée est que votre travail est un flux, comme un cours d'eau ou un courant électrique et que vous avez la possibilité de brancher les entrées et les sorties de vos commandes les unes aux autres.</p>

<p>Les branchements sont :</p>

<ul>
<li>&ldquo;;&rdquo; juste pour enchaîner les commandes</li>
<li>&ldquo;&amp;&amp;&rdquo; pour enchaîner les commandes uniquement tant que les commandes s'exécutent sans problème</li>
<li>&ldquo;|&rdquo; prendre en entrée la sortie d'une autre commande</li>
<li>&ldquo;&lt;&rdquo; donne en entrée la sortie d'une autre commande</li>
<li>&ldquo;>&rdquo; écrire et remplacer le contenu de la commande dans un fichier</li>
<li>&ldquo;>>&rdquo; écrire ajouter le contenu de la commande dans un fichier</li>
</ul>


<p>En pratique, pour mettre à jour un fichier de configuration par exemple après avoir créé commander un nouveau serveur, vous voulez :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>- créer l'utilisateur jvaljean 
</span><span class='line'> - créer un groupe admin
</span><span class='line'> - mettre jvaljean dans ce groupe
</span><span class='line'> - donner les droits de sudo aux membres de ce groupe 
</span><span class='line'> - interdire l'accès à votre machine à l'utilisateur root depuis SSH</span></code></pre></td></tr></table></div></figure>


<p>Vous pouvez taper les commandes suivantes :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>adduser jvaljean
</span><span class='line'>groupadd admin
</span><span class='line'>adduser jvaljean admin
</span><span class='line'>nano /etc/sudoers <span class="o">(</span>et ajouter <span class="s2">&quot;%admin    ALL=(ALL) ALL&quot;</span> à la fin du fichier<span class="o">)</span>
</span><span class='line'>nano /etc/ssh/sshd_config <span class="o">(</span>et remplacer <span class="s2">&quot;PermitRootLogin yes&quot;</span> par <span class="s2">&quot;PermitRootLogin no&quot;</span><span class="o">)</span>
</span><span class='line'>relancer le service /etc/init.d/ssh restart
</span></code></pre></td></tr></table></div></figure>


<p>ou bien faire :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>adduser jvaljean <span class="o">&amp;&amp;</span> groupadd admin <span class="o">&amp;&amp;</span> adduser jvaljean admin <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&quot;%admin    ALL=(ALL) ALL&quot;</span> &gt;&gt; /etc/sudoers <span class="o">&amp;&amp;</span> sudo sed -i -e <span class="s1">&#39;s/PermitRootLogin yes/PermitRootLogin no/g&#39;</span> /etc/ssh/sshd_config <span class="o">&amp;&amp;</span> sleep <span class="m">2</span> <span class="o">&amp;&amp;</span> sudo /etc/init.d/ssh restart
</span></code></pre></td></tr></table></div></figure>


<p>Pour connaître les IP qui se sont connectés à votre serveur le &ldquo;30 août entre 6 et 7 vous pouvez :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>récupère votre fichier de log (scp ou ftp)
</span><span class='line'>l'importer sur Excel
</span><span class='line'>utiliser les filtres pour obtenir l'information</span></code></pre></td></tr></table></div></figure>


<p>ou faire :</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>zcat /var/log/apache2/xwiki-access.log <span class="p">|</span> grep <span class="s2">&quot;30/Aug/2015:06&quot;</span> <span class="p">|</span> <span class="se">\</span>
</span><span class='line'>awk <span class="s1">&#39;{split($0,a,&quot; &quot;); print a[1]}&#39;</span> <span class="p">|</span> sort -nu
</span></code></pre></td></tr></table></div></figure>


<p>ou pour connaître la navigation de 192.168.1.10 le 30 Août 2015</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>zcat /var/log/apache2/xwiki-access.log.6.gz <span class="p">|</span> grep <span class="s2">&quot;30/Aug/2015&quot;</span> <span class="p">|</span> <span class="se">\</span>
</span><span class='line'>grep <span class="s2">&quot;192.168.1.10&quot;</span> <span class="p">|</span> awk <span class="s1">&#39;{split($0,a,&quot; &quot;); print a[4] a[6] a[7]}&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Et puis pour s'envoyer par mail le nombre d'IP connecter en une journée en une commande</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">TIMESLOT</span><span class="o">=</span><span class="sb">`</span>date +%d/%b/%Y<span class="sb">`</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
</span><span class='line'><span class="nv">NIP</span><span class="o">=</span><span class="k">$(</span>cat /var/log/apache2/xwiki-access.log <span class="p">|</span> grep <span class="s2">&quot;$TIMESLOT&quot;</span> <span class="p">|</span> <span class="se">\</span>
</span><span class='line'>awk <span class="s1">&#39;{split($0,a,&quot; &quot;); print a[1]}&#39;</span> <span class="p">|</span> sort -nu <span class="p">|</span> wc -l<span class="k">)</span> <span class="se">\</span>
</span><span class='line'><span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s2">&quot;$NIP on $TIMESLOT&quot;</span> <span class="p">|</span> mail -s <span class="s2">&quot;$NIP on $TIMESLOT&quot;</span> jvaljean@gmail.org
</span></code></pre></td></tr></table></div></figure>


<h2>Conclusion</h2>

<p>Probablement rien de nouveau sous le soleil je pense, mais je me suis dit qu'il était préférable d'avoir parlé de ces bases, avant de passer à la suite.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">kanedafromparis</span></span>

      




<time class='entry-date' datetime='2014-10-03T21:53:12+02:00'><span class='date'><span class='date-month'>Oct</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2014</span></span> <span class='time'>9:53 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/bases/'>bases</a>, <a class='category' href='/blog/categories/bash/'>bash</a>, <a class='category' href='/blog/categories/run/'>run</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://kanedafromparis.github.io/blog/2014/10/03/bash-basics/" data-via="@kanedafromparis" data-counturl="http://kanedafromparis.github.io/blog/2014/10/03/bash-basics/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="small"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/07/29/bonjour-le-monde/" title="Previous Post: Bonjour le monde">&laquo; Bonjour le monde</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/10/12/SSH-basics/" title="Next Post: Les bases de SSH">Les bases de SSH &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/10/16/Netbeans_Days_Paris/">NetBeans Days</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/15/Ansible/">Permiers Pas Avec Ansible, Impression Perso</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/12/SSH-basics/">Les Bases De SSH</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/10/03/bash-basics/">Les Bases De La Ligne De Commandes</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014/07/29/bonjour-le-monde/">Bonjour Le Monde</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/kanedafromparis">@kanedafromparis</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'kanedafromparis',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



<section class="googleplus googleplus-hidden">
  <h1>
    <a href="https://plus.google.com/kanedafromparis?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - kanedafromparis -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
